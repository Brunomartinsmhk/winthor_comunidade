    SELECT  PCPEDI.CODPROD,
            PCPRODUT.NBM,
            PCPRODUT.DESCRICAO,
            PCPRODUT.EMBALAGEM,
            PCPRODUT.UNIDADE,
            PCPRODUT.CODAUXILIAR,
            MAX(PCPEDI.CODFILIALRETIRA) CODFILIALRETIRA, 
            MAX(PCPEDI.TIPOENTREGA) TIPOENTREGA,
            MIN(PCPEDC.DTENTREGA) DTINI,
            MAX(PCPEDC.DTENTREGA) DTFIM,
            SUM(PCPEDI.QT) QT,
            SUM(ROUND(NVL(PCPEDI.QT, 0) * NVL(PCPEDI.PVENDA, 0), 2)) VLATEND 
    FROM PCPRODUT, PCPEDI, PCCLIENT, PCUSUARI, PCPRACA,  PCEMPR FUNCEMIT, PCEMPR FUNCMOTO, PCEMPR FUNCLIBERA, PCEMPR FUNCCONF,PCCARREG CARREG, PCVEICUL VEICULO, PCPEDC
    WHERE PCPEDC.CODCLI        = PCCLIENT.CODCLI
    AND   PCPEDI.CODPROD       = PCPRODUT.CODPROD
    AND   PCPEDC.CODUSUR       = PCUSUARI.CODUSUR
    AND   PCPEDC.NUMPED        = PCPEDI.NUMPED
    AND   PCPEDC.CODPRACA      = PCPRACA.CODPRACA
    AND   PCPEDC.CODEMITENTE   = FUNCEMIT.MATRICULA(+)
    AND   CARREG.CODMOTORISTA  = FUNCMOTO.MATRICULA(+)
    AND   PCPEDC.CODFUNCLIBERA = FUNCLIBERA.MATRICULA(+)
    AND   PCPEDC.CODFUNCCONF   = FUNCCONF.MATRICULA(+)
    AND   PCPEDC.NUMCAR        = CARREG.NUMCAR(+)
    AND   CARREG.CODVEICULO    = VEICULO.CODVEICULO(+)
    AND PCPEDC.DTENTREGA >=:DTINI
    AND PCPEDC.DTENTREGA <=:DTFIM
      AND NVL(PCPEDC.CODFILIAL,' ') IN(:CODFILIAL)
      AND PCPEDC.CODCLI IN(:CODCLI)
    AND PCPEDC.POSICAO IN ('','M','L','B','P','')
    AND PCPEDC.CODUSUR = :CODRCA
    AND PCCLIENT.ESTENT = :UF
    AND PCCLIENT.CODREDE = :CODREDE
    GROUP BY PCPEDI.CODPROD, 
             PCPRODUT.DESCRICAO, 
             PCPRODUT.EMBALAGEM, 
             PCPRODUT.UNIDADE,
             PCPRODUT.CODAUXILIAR,
             PCPRODUT.TIPOESTOQUE,
             PCPRODUT.NBM
    ORDER BY QT DESC, PCPEDI.CODPROD